apply plugin: "org.openapi.generator"

openApiGenerate {
    generatorName.set("spring")
    library.set("spring-boot")
    inputSpec.set("$rootDir/boundary-module/src/main/resources/api/price-boundary.yaml")
    outputDir.set("$rootDir/boundary-module/build/generated-sources/openapi")
    apiPackage.set("com.sternitc.generated.api.boundary")
    invokerPackage.set("com.sternitc.generated.api.boundary.invoker")
    modelPackage.set("com.sternitc.generated.api.boundary.model")
    generateApiTests.set(false)
    generateModelTests.set(false)
    generateApiDocumentation.set(false)
    globalProperties.set([
            "generateSupportingFiles": "false"
    ])
    configOptions.set([
            "dateLibrary"      : "java8",
            "reactive"         : "true",
            "interfaceOnly"    : "true",
            "delegatePattern"  : "true",
            "useBeanValidation": "true",
            "useTags"          : "true"
    ])
}

sourceSets {
    main {
        java {
            srcDir file("$rootDir/boundary-module/build/generated-sources/openapi/src/main/java")
        }
    }
//    test {
//        java {
//            srcDir file("${project.buildDir}/openapi/src/main/java")
//        }
//    }
}

compileJava.dependsOn tasks.named("openApiGenerate")